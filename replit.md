# ContentScale AI Platform - Replit Development Guide

## Overview

ContentScale is an advanced AI-powered content writing platform that provides real-time AI visualization, SEO optimization, and competitive analysis. The platform is branded as "Sofeia AI" and features a sophisticated chat interface with live AI thinking processes, keyword research capabilities, and premium subscription features.

**Latest Enhancement (July 18, 2025):** ELITE SEO CONTENT PROMPT INTEGRATION - Upgraded SEO mode with state-of-the-art content ranking optimization system:

**ELITE SEO FEATURES:**
- **Elite Content & Ranking Master**: Multi-phase SEO system with live competitive intelligence, strategic content planning, and C.R.A.F.T framework application
- **Google AI Overview Optimization**: Specialized prompts for featured snippets and AI Overview prominence
- **Country-Specific Research**: Targeted analysis with .gov/.edu authority sources and local market intelligence
- **Technical HTML Excellence**: Copy-paste ready content with professional formatting, tables, and active hyperlinks

**Previous Enhancement (July 18, 2025):** PROFESSIONAL PROMPT INTEGRATION - Integrated three state-of-the-art professional AI prompts into specialized chat modes for maximum effectiveness:

**PROFESSIONAL-GRADE PROMPTS:**
- **Manus Pro**: Ultimate autonomous research & analysis prompt with multi-phase execution framework, strategic synthesis capabilities, and PhD-level expertise across all domains
- **Replit Pro**: Master full-stack development prompt with architecture-first approach, modern tech stack integration, and production-ready code standards  
- **Grant Writing**: Elite grant proposal mastery prompt with funder psychology integration, compliance verification, and persuasive writing techniques optimized for funding success

**Previous Enhancement (July 18, 2025):** ENHANCED CONTENT CREATION SYSTEM - Complete C.R.A.F.T framework integration with copy-paste ready HTML functionality:

**COMPREHENSIVE CONTENT FEATURES:**
- Complete Julia McCoy C.R.A.F.T framework (Cut fluff, Review/optimize, Add visuals, Fact-check, Trust-build)
- Copy-paste ready HTML formatting with proper tags (h1, h2, h3, h4, tables, citations)
- HTML copy button with dual functionality (formatted text + raw HTML)
- Professional styled tables for Word/Google Docs compatibility
- Government source prioritization with active hyperlinks (.gov, .edu domains)
- Google AI Overview optimization when AI Overviews detected for keywords
- NLP semantic analysis with keyword clustering and topic relationships
- Country-specific keyword research and competitive analysis
- Professional numbered citations with authoritative source links

**Latest Enhancement (July 18, 2025):** WRITING-FOCUSED CHAT SYSTEM - Optimized chat to prioritize content generation over testing responses:

**WRITING-FIRST APPROACH:**
- Only basic greetings get simple responses - everything else triggers full AI processing
- Eliminated test-focused responses to prioritize actual content creation and assistance
- All four modes now focus exclusively on generating useful, comprehensive content
- System automatically routes all complex requests to specialized AI processing

**Enhancement (July 17, 2025):** FOUR SPECIALIZED CHAT MODES - Completely redesigned chat interface with four distinct AI modes now powered by professional-grade prompts:

**1. Manus Pro** - Ultimate autonomous research & analysis with multi-dimensional analysis framework and strategic synthesis capabilities
**2. Professional Grant Writing** - Elite grant proposal mastery with funder psychology integration and compliance verification systems  
**3. General + SEO Assistance** - Advanced content strategy with live research and competitive analysis
**4. Replit Pro** - Master full-stack development with architecture-first approach and production-ready standards

**Previous Enhancement (July 11, 2025):** CRITICAL FIXES & UI IMPROVEMENTS - Fixed conversation creation errors and implemented UI layout rearrangement based on user feedback. Key fixes implemented:

**CRITICAL FIXES:**
- **Conversation Creation Error Fix**: Enhanced error handling in `/api/conversations` endpoint with proper user initialization and validation
- **Improved Error Messages**: Added specific error descriptions for better debugging and user feedback
- **Database User Handling**: Automatic user creation when missing, preventing conversation creation failures
- **Demo Mode Stability**: Fixed demo user creation process with proper error handling

**UI LAYOUT REARRANGEMENT:**
- **Middle Column**: Now displays "Welcome to Sofeia AI" section (Keyword Research, SEO Strategy, Content Analysis)
- **Right Sidebar**: Moved "AI Brain Activity" section with real-time thinking process and API integrations
- **Left Sidebar**: Maintained chat history and conversation management (unchanged)
- **Three-Column Layout**: Clean separation between chat history, main interface, and AI activity monitoring

**UPDATED PRICING STRUCTURE (July 17, 2025)** - Pro plan restored to $35 for 150 questions with WhatsApp contact for unlimited access:
- **2-Tier Pricing Structure:** Free (3/day), Pro ($35 for 150 questions/month - contact WhatsApp for unlimited)

**GROQ AI INTEGRATION (July 17, 2025)** - Added Groq as primary AI service for grant writing with intelligent fallbacks:
- **Groq Primary Service:** Fast Llama-3.1-70B model for grant writing and general content
- **Intelligent Fallback System:** Uses Perplexity + Claude when Groq needs research/internet access
- **Grant Writing Optimization:** Specialized prompts for NIH, NSF, and foundation grant proposals
- **Performance Benefits:** Faster response times for content that doesn't require live research
- **Enhanced Token Limits:** Increased to 8000 tokens across all AI services for better large content processing
- **Google Drive Integration:** Added URL reading capability for processing documents and research papers
- **Enhanced Memory System:** Improved conversation context retention and user preference storage

**MANUS AI-STYLE GENERAL CHAT (July 17, 2025)** - Enhanced general chat to work like Manus AI with comprehensive question-answering:
- **Universal Question Handling:** Routes almost all questions to full AI processing for comprehensive answers
- **Multi-Domain Expertise:** Programming, math, science, business, creative writing, technical support
- **Advanced Problem Solving:** Debugging code, solving complex problems, providing step-by-step solutions
- **Comprehensive System Prompt:** Updated to handle technical development, academic research, business strategy
- **Minimal Simple Responses:** Only ultra-basic greetings get instant responses, everything else gets full AI
- **Enhanced Capabilities Display:** Simple responses now showcase full range of Manus AI-like capabilities
- **Usage-Based Overage Fees:** $0.25 per additional question beyond monthly limits for paid plans (Free users must upgrade)
- **Annual Billing Discounts:** 15-20% discount for yearly subscriptions (Pro: $28/month, Agency: $79/month, Premium Agency: $199/month)
- **ROI-Focused Marketing:** Messaging highlights time savings, revenue increase potential, and business growth rather than just cost
- **Bulk Generation Limits:** Bulk content generation now counts against monthly question limits and stops when exceeded
- **Enhanced Subscription Manager:** Tracks both regular and overage questions with proper billing integration
- **Database Schema Updates:** Added billingCycle and overageQuestionsUsed fields for comprehensive usage tracking
- **Premium Agency Tier:** Maximum tier at $249/month for 1500 questions with priority support and beta access
- **Annual Savings Calculator:** Dynamic pricing display showing exact savings amounts for annual billing
- **Overage Billing System:** Automatic tracking and billing for questions exceeding monthly limits
- **Government Statistics Integration:** Enhanced both Anthropic and Perplexity services to prioritize real government statistics and official sources
- **Country-Specific Data:** Added comprehensive country-specific government source mapping for 8 major markets (US, UK, Canada, Australia, Germany, France, Netherlands, Spain)
- **High-Authority Sources Only:** Configured AI to avoid competitors and low-DR sites, focusing exclusively on .gov, .edu, and official international organization sources
- **AI Overview Optimization:** Added conditional AI Overview optimization prompts that only appear when AI Overviews are actually found for specific keywords, with targeted instructions: "Rewrite this to directly answer the query '[keyword with AI Overview]' in 2–3 concise, fact-based sentences optimized for Google's AI Overview format."
- **Comprehensive SEO Enhancement (July 11, 2025):** Implemented advanced SEO optimization targeting 50+ content scale keywords including:
  - Extended meta keywords targeting content scale, AI content writing, bulk content creation, content scaling platform, automated content marketing
  - Advanced Schema.org markup with WebSite, Organization, SoftwareApplication, Service, WebPage, BreadcrumbList, and FAQPage schemas
  - Enhanced Open Graph and Twitter Card tags with content scale branding
  - Comprehensive sitemap.xml with content scale focused pages and proper priority structure
  - Optimized robots.txt for content scale SEO with crawl directives
  - PWA manifest.json for enhanced mobile experience and app-like functionality
  - Landing page content optimized for "Scale Content Production 10x Faster" messaging
  - Content scale keywords grid showcasing platform capabilities
  - Google Analytics 4 and Microsoft Clarity integration for content scale tracking

**Local Authentication System (July 17, 2025):** Completely replaced Auth0 with secure local authentication system and removed all demo functionality per user request:
- Secure password hashing using Node.js crypto.scrypt with salt
- Local user registration and login with email/password
- Session-based authentication with secure HttpOnly cookies
- Protected routes requiring authentication
- Beautiful authentication forms with input validation
- No third-party authentication providers required
- Complete user data privacy and control
- **ALL DEMO FUNCTIONALITY REMOVED:** Users now go directly to real platform after login
- Clean authentication flow without demo modes or fallbacks

**COMPREHENSIVE SECURITY SYSTEM (July 17, 2025):** Implemented enterprise-grade security measures to protect against fraud, abuse, and unauthorized access:
- **IP Tracking & Rate Limiting:** 100 requests/hour, 1000/day limits with automatic blacklisting
- **Admin IP Whitelist Management:** Admin panel at `/admin/security` for managing trusted IP addresses that bypass all security checks
- **IP Blacklist Management:** Admin controls to manually block/unblock IP addresses and clear entire blacklist
- **Automatic Admin Protection:** Admin IP (112.198.166.106) auto-whitelisted on startup to prevent lockouts
- **VPN/VPS/Proxy Detection:** Real-time blocking of virtual private networks, proxy services, and hosting providers
- **Incognito/Private Browsing Detection:** Multi-method client-side detection with storage quota, IndexedDB, and WebRTC tests
- **Browser Fingerprinting:** Canvas, WebGL, and device characteristic tracking for unique user identification
- **Geographic Restrictions:** Country-based blocking for high-risk regions (configurable)
- **Suspicious User Agent Detection:** Automated blocking of bots, crawlers, scrapers, and headless browsers
- **Device Registration:** Multi-device tracking with suspicious behavior monitoring
- **Real-time Security Monitoring:** Admin panel access to security stats, blacklisted IPs, and threat analysis
- **Advanced Threat Scoring:** Risk calculation based on multiple factors including IP intelligence and behavior patterns
- **Automatic Security Responses:** Progressive blocking from warnings to permanent IP blacklisting based on violation severity
- **Admin Security Dashboard:** Comprehensive UI for managing security settings, viewing suspicious activity, and controlling IP access

**Admin System & Grant Writing (July 2025):** Implemented full admin functionality for ottmar.francisca1969@gmail.com with unlimited credits, user management capabilities, and professional grant writing features:
- Unlimited credits and question allowance for admin users
- Large content processing capability for Google Drive documents and research papers
- AI trained specifically for professional grant writing (NIH, NSF, foundation standards)
- Context-aware grant writing with reference document integration
- Advanced homepage features with grant writing toggle mode
- Professional grant proposal generation with best-in-class training

## User Preferences

Preferred communication style: Simple, everyday language.

## Current Status (July 2025)

**DEPLOYMENT STATUS (JULY 18, 2025): ✅ SUCCESSFULLY DEPLOYED TO RENDER**
- App is live and functional at Render URL
- Registration/login forms working correctly
- Database connections established
- All AI features operational
- Build issues resolved with --include=dev flag
- Port configuration fixed for production environment

**Authentication Status (COMPLETELY FIXED - July 11, 2025):**
- ✅ All authentication errors resolved (unknown_user_id, strategy errors)
- ✅ Intelligent fallback system automatically handles authentication failures
- ✅ Production-ready Replit OAuth integration with error recovery
- ✅ Robust session management with memory store fallback
- ✅ Strategy detection and automatic demo mode redirection
- ottmar.francisca1969@gmail.com automatically receives unlimited credits and admin privileges

**Subscriber Access Plan:**
- Demo mode available now for testing all features
- Admin panel accessible at /admin route for user management
- System status page at /status for monitoring authentication health
- Real authentication will work for subscribers once Replit OIDC configuration is resolved

**Immediate Access Methods:**
1. Demo Mode: Full chat interface without login
2. Admin Panel: Direct access to user management
3. Status Page: Monitor system health and authentication status

**Immediate Access Methods:**
1. Demo Mode: Full chat interface without login
2. Admin Panel: Direct access to user management
3. Status Page: Monitor system health and authentication status

## System Architecture

### Frontend Architecture
- **Framework**: React 18 with TypeScript
- **UI Framework**: Radix UI components with Tailwind CSS styling
- **Routing**: Wouter for client-side routing
- **State Management**: TanStack Query for server state management
- **Build Tool**: Vite with custom configuration for development and production

### Backend Architecture
- **Runtime**: Node.js with Express.js framework
- **Language**: TypeScript with ES modules
- **Database ORM**: Drizzle ORM for type-safe database operations
- **Real-time Communication**: WebSocket server for live AI activity feeds
- **Authentication**: Replit Auth integration with session management

### Design System
- **Component Library**: Shadcn/UI components (New York style)
- **Styling**: Tailwind CSS with CSS variables for theming
- **Icons**: Lucide React icons and Font Awesome
- **Typography**: Inter font family
- **Color Scheme**: Dark theme with slate color palette and indigo accents

## Key Components

### Authentication System
- **Local Authentication**: Secure email/password authentication without third-party dependencies
- **Password Security**: Industry-standard scrypt hashing with unique salts for each password
- **Session Management**: Secure session-based authentication with HttpOnly cookies
- **User Registration**: Simple signup process with email validation and password strength requirements
- **Protected Routes**: Automatic redirection to login for unauthorized access
- **User Profiles**: Complete user management with subscription status and usage tracking
- **Admin System**: Built-in admin privileges with unlimited access and user management capabilities

### Chat Interface
- Real-time chat interface with conversation management
- WebSocket connection for live AI activity visualization
- Message history with role-based display (user/assistant)
- Conversation creation and management

### AI Services Integration
- **Anthropic Claude Sonnet 4**: Primary AI service using comprehensive Sofeia AI training prompt
- **Advanced Training Protocol**: C.R.A.F.T framework implementation (Cut fluff, Review/optimize, Add visuals, Fact-check, Trust-build)
- **Content Optimization**: Google AI Overview targeting, HTML formatting, and copy-paste ready output
- **Live Research**: Competitor analysis integration with real-time data sourcing
- **Perplexity API**: Keyword research and competitive analysis with country-specific targeting
- Advanced content analysis with SEO scoring and optimization

### Subscription System
- PayPal integration for premium subscriptions
- Free tier with 3 daily questions limit
- Pro tier with unlimited questions and advanced features
- Usage tracking and daily limit resets

### Real-time AI Visualization
- Live AI thinking process display
- Activity feed showing research, analysis, strategy, and generation phases
- Real-time status updates through WebSocket connections

## Data Flow

1. **User Authentication**: Users authenticate via Replit OAuth, creating or updating user records
2. **Conversation Management**: Users create conversations which store message history
3. **AI Processing**: User messages trigger AI service calls with real-time activity tracking
4. **WebSocket Updates**: AI activities are broadcast to connected clients for live visualization
5. **Response Generation**: AI responses are stored and displayed in the chat interface

## External Dependencies

### Core Services
- **Neon Database**: PostgreSQL database hosting
- **Anthropic API**: AI content generation and analysis
- **Perplexity API**: Research and keyword analysis capabilities
- **PayPal SDK**: Payment processing for subscriptions
- **Replit Auth**: User authentication and session management

### Development Tools
- **Drizzle Kit**: Database migrations and schema management
- **ESBuild**: Production bundling for server code
- **Vite**: Frontend development and building
- **TypeScript**: Type checking and compilation

### UI Libraries
- **Radix UI**: Accessible component primitives
- **Tailwind CSS**: Utility-first styling framework
- **Lucide React**: Icon library
- **TanStack Query**: Server state management

## Deployment Strategy

### Development Environment
- Vite dev server with HMR for frontend development
- TSX runtime for server development with auto-restart
- Shared TypeScript configuration for client, server, and shared code

### Production Build
- Vite builds optimized client bundle to `dist/public`
- ESBuild bundles server code to `dist/index.js`
- Static file serving through Express.js
- Environment variable configuration for API keys and database connections

### Database Management
- Drizzle migrations stored in `./migrations` directory
- Schema definitions in `shared/schema.ts` for type safety
- Database push commands for development schema updates

### Configuration Requirements
- `DATABASE_URL`: PostgreSQL connection string
- `ANTHROPIC_API_KEY`: Claude API access
- `PERPLEXITY_API_KEY`: Research API access
- `PAYPAL_CLIENT_ID` & `PAYPAL_CLIENT_SECRET`: Payment processing
- `SESSION_SECRET`: Session encryption key
- `REPL_ID` & related Replit environment variables

The application follows a monorepo structure with shared types and schemas, enabling type-safe communication between frontend and backend while maintaining clean separation of concerns.

## Deployment Guide

A comprehensive Render deployment guide has been created in `RENDER_DEPLOYMENT_GUIDE.md` with:
- Step-by-step GitHub to Render deployment process
- Complete environment variable configuration
- API key setup instructions (Anthropic, Groq, Perplexity)
- Database setup and schema management
- Production optimization settings
- Troubleshooting common deployment issues
- Security and scaling considerations